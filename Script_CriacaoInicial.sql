DECLARE @CurrentMigration [nvarchar](max)

CREATE DATABASE DefaultConnection;

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'GerenciamentoAlunos.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201608301444138_CriacaoEntidadeAluno'
BEGIN
    CREATE TABLE [dbo].[Alunoes] (
        [Id] [int] NOT NULL IDENTITY,
        [Ra] [int] NOT NULL,
        [Nome] [nvarchar](255) NOT NULL,
        [Cidade] [nvarchar](255) NOT NULL,
        CONSTRAINT [PK_dbo.Alunoes] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[AspNetRoles] (
        [Id] [nvarchar](128) NOT NULL,
        [Name] [nvarchar](256) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetRoles] PRIMARY KEY ([Id])
    )
    CREATE UNIQUE INDEX [RoleNameIndex] ON [dbo].[AspNetRoles]([Name])
    CREATE TABLE [dbo].[AspNetUserRoles] (
        [UserId] [nvarchar](128) NOT NULL,
        [RoleId] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserRoles]([UserId])
    CREATE INDEX [IX_RoleId] ON [dbo].[AspNetUserRoles]([RoleId])
    CREATE TABLE [dbo].[AspNetUsers] (
        [Id] [nvarchar](128) NOT NULL,
        [Email] [nvarchar](256),
        [EmailConfirmed] [bit] NOT NULL,
        [PasswordHash] [nvarchar](max),
        [SecurityStamp] [nvarchar](max),
        [PhoneNumber] [nvarchar](max),
        [PhoneNumberConfirmed] [bit] NOT NULL,
        [TwoFactorEnabled] [bit] NOT NULL,
        [LockoutEndDateUtc] [datetime],
        [LockoutEnabled] [bit] NOT NULL,
        [AccessFailedCount] [int] NOT NULL,
        [UserName] [nvarchar](256) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUsers] PRIMARY KEY ([Id])
    )
    CREATE UNIQUE INDEX [UserNameIndex] ON [dbo].[AspNetUsers]([UserName])
    CREATE TABLE [dbo].[AspNetUserClaims] (
        [Id] [int] NOT NULL IDENTITY,
        [UserId] [nvarchar](128) NOT NULL,
        [ClaimType] [nvarchar](max),
        [ClaimValue] [nvarchar](max),
        CONSTRAINT [PK_dbo.AspNetUserClaims] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserClaims]([UserId])
    CREATE TABLE [dbo].[AspNetUserLogins] (
        [LoginProvider] [nvarchar](128) NOT NULL,
        [ProviderKey] [nvarchar](128) NOT NULL,
        [UserId] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey], [UserId])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserLogins]([UserId])
    ALTER TABLE [dbo].[AspNetUserRoles] ADD CONSTRAINT [FK_dbo.AspNetUserRoles_dbo.AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [dbo].[AspNetRoles] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserRoles] ADD CONSTRAINT [FK_dbo.AspNetUserRoles_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserClaims] ADD CONSTRAINT [FK_dbo.AspNetUserClaims_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserLogins] ADD CONSTRAINT [FK_dbo.AspNetUserLogins_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201608301444138_CriacaoEntidadeAluno', N'GerenciamentoAlunos.Migrations.Configuration',  0x1F8B0800000000000400DD5CDB6EE336107D2FD07F10F4D416A9954B77B10DEC16A9936C836E2E88B345DF16B4443BC24A942A516982A25FD6877E527FA1A4445D78D3CDB2AD140B2C62893C331C1E92C3F18CFFFDFB9FE98FCFBE673CC128760334338F2687A601911D382E5ACFCC04AFBE7D67FEF8C3975F4C2F1CFFD9F8356F7742DB919E289E998F1887A79615DB8FD007F1C477ED288883159ED8816F0127B08E0F0FBFB78E8E2C48204C826518D3FB0461D787E907F2711E201B863801DE75E0402F66CFC99B458A6ADC001FC621B0E1CC7C0F23A2A04B1E201C9C79090AE249D6CB34CE3C17108D16D05B99064028C000137D4F3FC67081A300AD17217900BC87971092762BE0C5908DE3B46CDE764887C7744856D93187B29318077E47C0A31366234BECDECBD266614362C50B626DFC42479D5A7266A676330D51D2E9DC8B68AB3A2B4FD24F0786A2C5414110C223FAEFC098271E4E22384330C111F00E8CBB64E9B9F62FF0E521F80CD10C259E575595284BDE710FC8A3BB280861845FEEE18A0DE0CA310D8BEF67891D8B6E953ED9E8AE103E39368D1B221C2C3D5830A16289050E22F81E2218010C9D3B80318C10C580A92D25E982AC7BD024ABBEFF4DE0C31C815097AC46D3B806CF1F205AE3C79979FCE68D695CBACFD0C99F30D48FC8258B9774C251023B4B9DBB0E70B62E776A957CAC65696EECFBC0837564BD2E16C2591CDE403CC93B4E32C8CB88C0FD11449F2755C403A375BF92D8C76D897D72B45C9DBC7BF31638276FBF83276F764F72C5F41D1DBFDB066DE8FFB5A4793B88D41BF0E4AED3A917E493ED3D22BBFF3DF4D2B7F1A31B66870037DF9F58B3CB28F0E9679E5FD9DB4F8B20896C3A9840DBE401446B8837A434851A9ED639EAF8A94D3595E9AD6C4A07D46725E42276BD1A727DB72BB735E3CEC2904C5E4A2D6A91BE873E8FF2BA8FFFDD71E1C207AE37C0D6D8420AF1A1576EE4C362943F0584880075D6F90EC431D9199C9F41FC58A33AF97300D517D04E2242D805067EB87569778F01823789BFA4EB6077B2069B9A873F824B6013CFF402D15E1BE37D08ECCF41822F90734EBCDC8FD8CE01E9C707D76F0F30883A67B60DE3F89290193AF3805C1137F3A1E946B56FD764EE01D757FB26C296FA296F5AFA27EA16928FA269A6F253EA54FD10AC5DD44ED5BCA95ED5AC45A3AAAC59575529583B4D594BBDA26983463DB35683797EE90C0DEFFAA5B0E3F7FDC67E77DF97E3984E1F15BAF5B32995F42BF092A145F55A0DE92630FC6A4861C7BF1A5235C9E327D7A15E498B0B51DE98C0B76AAFBE6B35AF3941B35D2F076E98BB16BE9B3D40B75CCEE23820772BBA0A14A13016C8E0F5273E9CD11CD5C846234646C8C008D15D7AE49127646CA648AA5B740E3D88A171666701ED3988ED345428928AE8D141B1FC44552856464878E5BE916412A6D3CB280DEC134F3B262BD545585E162EB9AE86C06BB492D0B3E51146C75EC810DF9CC310222AB0D1126D84AB03225481428E30294D169A5A15C6D51351E3B5EAE6BCC9852DE75D8A53EC84930DBEB38697CC7FDB0A31EB2DB60372D69BA48D02DAE0DE3E08CAEE2A6D09205E5CC64650E1C6A4212873A9764250DE627B20286F925747D0EC8ADA76FE85FBEAD8E8C95F94777FACD79A6B0FDCE4EC31326A66BE27E983490F18C9F43C5FD297F0192B2E67444F763F8B99AB2B5284822F20AE661CC4A6513ABC396FB35404ABBE3B8BE348BD7937B60144E4601D60C9D30650F6ADA23C2E713D76502E0F05D66AC79C900EB079D8AE16961D1D026C85423276F5DBD54A43FD77B022B75B5D5E8A91156C90D648ABBB460547410871EFE307DEC228BAB0AE6C9836AE741767BA3230361935066A707C3546CA0733B895726A365B49E5CF75F1E836B292E07D69AC940F66702B318E361B49E15374F02A363211EF010CB4D8F24049715815EFA6569622C81E4C2D4D2EE1F41A84A18BD695DC42F6C458648985F36F17DD33EDFC0CC3B26345C25DA16D210907115843E12D114D34BD74A3189F030C96808689E68E2F35531ECD9AED3F17C99DBEF22CE60741DE9CFE9D7569CA005478330CE4928C91F64A870B2B0CD0F433689A27F040A488F9CF032FF191DE35D3F7A61978D5DEF473FBDE59FE5DB57FF6A43D429E4B57C5C89FC928534B309EE4FE49732539E9FCCCB7E2856E9FE8450BCE17EBCE8EFAEEDB2149F6F53037CD403DCD7B9A2079D31C78B20A3FB7FF84E9217466CF2F3955C3EB2E3E7A943C0ECAAD724D6C746F13A87378FB6DBCC29DA2C716DC84B09D75C6F2A0AA00EC51478C4A2A8D045679D71E95CF76AA62F26FDA230A294D5548E155072DAB894B9C92D517BDF0341655B7682F414E55AAA2CB6FDB232B9296AAD08AD73DB0153A8BEFDAA32AF29AAAC08AD7EDB1CB242771331DF149A6BDE96E7C94654191CDCE320DC67676C6618EC24AEA08E76F968F3B62B1E410098C3D1F25ABB491818D5995C5C43663950643BF1371C917FC46549B31A2C7E4322AB8CDBE2EA3448FD78DBB5B65881420109B14D28B4081101098B2CB797305A2745BCF9A98466E4672D0BFC418FA13DA60B2F8DD9B7B2EA4DB7ADEE01A207705639C651199C78747C742F1E2780A09AD38763C457043AA26E4276B0799802E356963AE5FD7EA0DC0C16F50B6879E40643F82482EA0DBA82AAF276CBFA2BB9DCFA9727469AED506356925A8F435D61572E0F3CCFC33ED759A8634E95FE9E303E32AFE88DCDF13F2E2214AA0F1979C3B3EACCDD537E9915654B5B7EAD56F9FB2AE07C66D44B6BF53E350B0659F19E6EBAC3A699375DD409BDED557AF774171A54C9A4D885B10FD2B97966EF79D5755B5946BF9950F9EBFEEAA9AB23269234445F5D15078839850575DD4074B5B59E4908F38AD2CEA365875A5511FD5B455467D0E7CB1C6A8FD3694F7DCE351A3B8E8BE5ABF6D5C679354CAB1D14297CB353AC06D5092D18319AFAC9A61B0D35151AC3018F63EA9BDF50A85B1142594F95EFBAD45D865F941CD777FFFABAA8311E4C92A12F7F65F5BB06BAEE982F3234FD0EE56413032B2B174CEFDD709EC9A6CBA98FDC8C9D6A91A60645CDBD7F9B967A6B53E42F79EDB2FE7198AD3AA48DAD7E7EC67DF7B903BFD927C78C87CC8F49522B75384E65D3D4902FF5A2928ADE6562792EA84953CD40A2C9BE885EA335825038A6B5236A5D8A25E6CB7B1325FA276B0AC4DBD584DDE779D6C76B4D4CA666DEA656BB2A9F75191A0CC67565589346C91754974AFA902811B4943C14B933B5C9B8CF19A0A0E06310AB77A34B904AFA7BE6010930CB9743AD413C86901E458AEFC7C31710D62775D42D01F3346D0E60EE4A2CD155A05B95F2068943711823FD71003879CD667117657C0C6E4350D5FA73F47918604E997284BE85CA1DB048709264386FED2E36269D4BFA8939F164DF03A4F6FC3F4979586180251D3A561FF5BF453E27A4EA1F7A522DCA481A08E0B0B16D3B9C43468BC7E29906E02D4128899AFF0B71EA01F7A042CBE450BF004FBE846E8F701AE81FD5206177520CD13C19B7D7AEE827504FC986194FDC947C261C77FFEE13F2814B19AC55B0000 , N'6.1.3-40302')
END

